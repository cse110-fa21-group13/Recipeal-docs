<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: searchbar.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: searchbar.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * Stores the added recipe Ids so we don't add duplicates from typing teach letter
 */
const addedRecipes = new Set(); 
// const addEachKeyup = 1; 
/* 
 * Function to search for recipe cards in search bar
 */
export function searchRecipe() {
    let input = document.getElementById("search-bar");
    let filter = input.value.toLowerCase();
    let recipeCardsElement = document.getElementById('recipe-cards'); 
    let allRecipes = recipeCardsElement.children; 

    for (let i = 0; i &lt; allRecipes.length; i++) {
        let currentRecipe = allRecipes[i]; 
        let name = currentRecipe.shadowRoot.querySelector('h1').textContent; 
        let lowerConverted = name.toLowerCase();
        if (lowerConverted.indexOf(filter) > -1) {
        currentRecipe.style.display = ""; 
        } else {
        currentRecipe.style.display = "none"; 
        }
    }
}

/**
 * @method filterTags 
 *  Checks the tag list of each existing recipe card. If the filter tag is not in a recipe's tag list,
 *  that recipe gets hidden. If the filter is being turned off, then check the list of tags still being
 *  filtered for against each recipe's tag list. If there is no intersection, display the recipe
 *  
 * @param {string} tag The filter to be applied
 */
export function filterTags(tag) {
    let recipeCards = document.getElementById("recipe-cards");
    let allRecipes = recipeCards.children;
    let tagBut = document.getElementById(`${tag}`);
    if(tagBut.classList.contains("filter-on")) {
        for(let i = 0; i &lt; allRecipes.length; i++) {
            let currentRecipe = allRecipes[i];
            console.log(currentRecipe);
            let currentRecipeName = currentRecipe.id.toLowerCase();
            console.log(currentRecipeName);
            let currentRecipeJSON = JSON.parse(localStorage.getItem(currentRecipeName));
            console.log(currentRecipeJSON);
            console.log(currentRecipeJSON.tags);
            let tags = currentRecipeJSON.tags;
            for(let i = 0; i &lt; tags.length; i++) {
                tags[i] = tags[i].toLowerCase();
            }
            if(!tags.includes(tag)) {
                currentRecipe.style.display = "none";
            }
        }
    } else {
        let filteredTags = document.getElementsByClassName("but but-secondary filter-on");
        let filtTagsArray = Array.from(filteredTags);
        for(let i = 0; i &lt; allRecipes.length; i++) {
            let currentRecipe = allRecipes[i];
            let currentRecipeName = currentRecipe.id.toLowerCase();
            let currentRecipeJSON = JSON.parse(localStorage.getItem(currentRecipeName));
            let tags = currentRecipeJSON.tags;
            if(filtTagsArray.every(val => tags.includes(val.id))) {
                currentRecipe.style.display = "";
            }
        } 
    }
}

/* 
 * Function to search for recipes in Spoonacular
 */
export function searchSpoon() {
    let input = document.getElementById("explore-search-bar");
    const filter = input.value.toLowerCase();
    let recipeCardsElement = document.getElementById('explore-wrapper');
    let allRecipes = recipeCardsElement.children; 

    if (filter === "") {
        addedRecipes.clear(); 
        currentRecipe.style.display = "";
    } else {
        for (let i = 0; i &lt; allRecipes.length; i++) {
            allRecipes[i].style.display = "none"; 
        }
        const API_KEY = "6b76530c7782467a8b83f2ad7ab1e35f";
        const SEARCH_URL = `https://api.spoonacular.com/recipes/complexSearch?query=${filter}&amp;number=3&amp;apiKey=${API_KEY}`;
        fetch (SEARCH_URL)
            .then(response => response.json())
            .then(data => {
                for (let i = 0; i &lt; data.results.length; i++) {
                    let recipeID = data.results[i].id; 
                    let recipeTitle = data.results[i].title;

                    // Prevents duplicate cards from showing up
                    if (addedRecipes.has(recipeTitle)) {
                        continue; 
                    } 

                    addedRecipes.add(recipeTitle); 
                    const RECIPE_INFO = `https://api.spoonacular.com/recipes/${recipeID}/information?apiKey=${API_KEY}`;
                    fetch(RECIPE_INFO)
                        .then(response1 => response1.json())
                        .then(info => {
                            // Creates recipe card
                            let recipeTime = info.readyInMinutes;
                            let recipeMin = recipeTime % 60;
                            let recipeHour = (recipeTime / 60);

                            let recipeSummary = info.summary;
                            recipeSummary = recipeSummary.replaceAll('&lt;b>', '');
                            recipeSummary = recipeSummary.replaceAll('&lt;/b>', '');
                            recipeSummary = recipeSummary.length > 173 ? recipeSummary.substring(0, 170) + "..." : recipeSummary;

                            const recipeData = {
                                thumbnail: info.image,
                                name: info.title,
                                description: recipeSummary,
                                time: { hours: recipeHour.toString(), minutes: recipeMin.toString() },
                            };

                            const recipeCard = document.createElement("recipe-card");
                            recipeCard.data = recipeData;
                            document.querySelector("#explore-wrapper").appendChild(recipeCard);
                        });
                }
            });
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addNewIngredientAddslabelandnewinputfieldforingredients">addNewIngredient
 Adds label and new input field for ingredients</a></li><li><a href="global.html#addNewStepAddslabelandnewinputfieldforsteps">addNewStep
 Adds label and new input field for steps</a></li><li><a href="global.html#addNewTagAddsnewinputfortags">addNewTag
 Adds new input for tags</a></li><li><a href="global.html#bindRecipeCardAddsaneventlistenertoeachrecipecardwhich,whenclicked,setstheexpandrecipepagetotherecipecard'sdataandnavigatestosaidrecipepage.">bindRecipeCard
 Adds an event listener to each recipe card which, when
 clicked, sets the expand recipe page to the recipe card's
 data and navigates to said recipe page.</a></li><li><a href="global.html#createRecipeButton">createRecipeButton</a></li><li><a href="global.html#filterTagsChecksthetaglistofeachexistingrecipecard.Ifthefiltertagisnotinarecipe'staglist,thatrecipegetshidden.Ifthefilterisbeingturnedoff,thencheckthelistoftagsstillbeingfilteredforagainsteachrecipe'staglist.Ifthereisnointersection,displaytherecipe">filterTags 
 Checks the tag list of each existing recipe card. If the filter tag is not in a recipe's tag list,
 that recipe gets hidden. If the filter is being turned off, then check the list of tags still being
 filtered for against each recipe's tag list. If there is no intersection, display the recipe</a></li><li><a href="global.html#handleImageUploadConvertsimagetodataUrltopreviewit">handleImageUpload
 Converts image to dataUrl to preview it</a></li><li><a href="global.html#imageUpload">imageUpload</a></li><li><a href="global.html#initCardsWhenpageisreloaded/refreshed,createsanewrecipecardforeachrecipeinlocalStorageandbindstheexpandedrecipepagetoit">initCards
 When page is reloaded/refreshed, creates a new recipe card
 for each recipe in localStorage and binds the expanded
 recipe page to it</a></li><li><a href="global.html#navEditCreateseditrecipepagethatcontainsdataforarecipeintheinputs">navEdit
 Creates edit recipe page that contains data for a recipe in the inputs</a></li><li><a href="global.html#newCardIfpassedrecipeexistsinlocalStorage,createsanewrecipecardwiththeexpandedrecipepageboundtoit.">newCard
 If passed recipe exists in localStorage, creates a new recipe
 card with the expanded recipe page bound to it.</a></li><li><a href="global.html#recipeExistsCheckstoseeifarecipeexistsinlocalstoragebycheckingthename">recipeExists
 Checks to see if a recipe exists in local storage
 by checking the name</a></li><li><a href="global.html#refreshRemovesrecipesandshows15otherrandomrecipes">refresh
 Removes recipes and shows 15 other random recipes</a></li><li><a href="global.html#resetClearsinputfieldsaftersaving">reset
 Clears input fields after saving</a></li><li><a href="global.html#saveBaseSavesdataininputfieldstolocalstorageResetstheinputfieldvaluesChangesscreentoexpandedrecipepageofsavedrecipe">saveBase
 Saves data in input fields to local storage
 Resets the input field values
 Changes screen to expanded recipe page of saved recipe</a></li><li><a href="global.html#saveDataCreateChecktomakesureinputfieldsarevalidorifrecipealreadyexistsIfitdoesn'tChangesscreentoexpandedrecipepageofsavedrecipe">saveDataCreate
 Check to make sure input fields are valid or if recipe already exists
 If it doesn't
 Changes screen to expanded recipe page of saved recipe</a></li><li><a href="global.html#saveDataEditSavesediteddataininputfieldstolocalstorageanddeletesoldrecipeResetstheinputfieldvaluesChangesscreentoexpandedrecipepageofsavedrecipe">saveDataEdit
 Saves edited data in input fields to local storage and deletes old recipe
 Resets the input field values
 Changes screen to expanded recipe page of saved recipe</a></li><li><a href="global.html#saveToMyRecipesSavesrecipesfromtheexplorepagetomyrecipesAllowsyoutoedittherecipebeforeyousave">saveToMyRecipes
 Saves recipes from the explore page to my recipes
 Allows you to edit the recipe before you save</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Tue Dec 07 2021 07:17:17 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
